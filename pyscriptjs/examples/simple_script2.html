<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />

    <title>PyScript simple script 2 demo</title>

    <link rel="icon" type="image/png" href="favicon.png" />
    <!-- <link rel="stylesheet" href="../build/pyscript.css" />     -->
    <script defer src="../build/pyscript.js"></script>
    <py-env>
      - paths:
        - /utils.py
    </py-env>
  </head>

  <body>
    <p>This example demonstrates various features:
      <ul class="list-disc">
        <li>
          <i>Start time</i> is computed as soon as the page is loaded,
          and it's placed into an HTML tag by using <tt>&lt;py-script output="outputDiv"&gt;</tt>.
        </li>

        <li>
          <i>Current time</i> is computed every second,
          using <tt>asyncio</tt>. The HTML tag is modified by using
          the <tt>Element</tt> class.
        </li>
      </ul>
    </p>

    <table>
      <tr>
        <th>Start time</th>
        <td id="outputDiv"></td>
      </tr>
      <tr>
        <th>Current time</th>
        <td id="outputDiv2"></td>
      </tr>
      <tr>
        <th>&nbsp;</th>
        <td id="outputDiv3"></td>
      </tr>
    </table>

    <py-script output="outputDiv">
import utils
utils.now()
    </py-script>

    <py-script>
from utils import now
import asyncio

async def foo():
  while True:
    await asyncio.sleep(1)
    output = now()
    pyscript.write("outputDiv2", output)
    
    out3 = Element("outputDiv3")
    if output[-1] in ["0", "4", "8"]:
      out3.write("It's espresso time!")
    else:
      out3.clear()

pyscript.run_until_complete(foo())
    </py-script>
  </body>
</html>
